# 前后端连接问题排查报告

> 2026-01-31

## 问题现象

前端浏览器报错：
```
GET http://localhost:8888/api/v1/logs?page=1&page_size=5 net::ERR_EMPTY_RESPONSE
Failed to load dashboard data: ApiError: Failed to fetch
```

## 排查结果

### 服务状态 ✅ 正常

| 服务 | 端口 | 进程状态 | 验证 |
|------|------|----------|------|
| 后端 (uvicorn) | 8888 | PID 815409 | ✅ curl 返回数据 |
| 前端 (vite) | 3000 | PID 813017 | ✅ 返回 HTML |

### API 验证 ✅ 全部正常

```bash
# 账号 API
curl http://localhost:8888/api/v1/accounts
# 返回: 4个账号 ✅

# 任务 API
curl http://localhost:8888/api/v1/tasks
# 返回: 3个任务 ✅

# 日志 API
curl http://localhost:8888/api/v1/logs?page=1
# 返回: 9条日志 ✅

# Dashboard API
curl http://localhost:8888/api/v1/dashboard/stats
# 返回统计数据 ✅
```

### 代码检查 ✅ 无问题

1. **前端 API 配置** (`frontend/.env`)
   ```
   VITE_API_BASE_URL=http://localhost:8888/api/v1
   ```

2. **CORS 配置** (`backend/app/core/config.py`)
   ```python
   CORS_ORIGINS: list[str] = ["http://localhost:3000", "http://127.0.0.1:3000", "*"]
   ```

3. **Vite 配置** (`frontend/vite.config.ts`)
   - 无代理配置，直接请求后端地址

## 问题定位

**curl 正常，浏览器异常** → 问题在浏览器端，非代码问题

可能原因：
1. **浏览器缓存** - 旧的失败请求被缓存
2. **浏览器扩展** - 广告拦截或隐私扩展阻止请求
3. **SSE 连接阻塞** - 浏览器端的 SSE 连接可能阻塞了其他请求
4. **浏览器网络问题** - 浏览器与 WSL 之间的网络异常

## 解决方案

### 方案 1：强制刷新浏览器
```
Ctrl + Shift + R (Windows/Linux)
Cmd + Shift + R (Mac)
```

### 方案 2：清除浏览器缓存
1. 打开开发者工具 (F12)
2. 右键刷新按钮 → "清空缓存并硬性重新加载"

### 方案 3：禁用浏览器扩展
暂时禁用所有扩展，尤其是广告拦截器

### 方案 4：使用无痕模式
打开无痕窗口访问 `http://localhost:3000`

### 方案 5：重启浏览器
完全关闭并重新打开浏览器

## 进一步排查

如果以上方法无效，检查：

1. **浏览器控制台网络标签**
   - 查看请求状态码
   - 查看请求头和响应头

2. **后端日志**
   ```bash
   tail -f /tmp/backend.log
   ```

3. **前端日志**
   ```bash
   tail -f /tmp/frontend.log
   ```

## 结论

**代码无问题**，前后端通信正常。问题为浏览器端缓存或扩展导致。
